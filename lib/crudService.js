!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.crudService=e():(t["react-services"]=t["react-services"]||{},t["react-services"].crudService=e())}(window,function(){return function(t){function e(e){for(var r,i,a=e[0],u=e[1],p=e[2],f=0,l=[];f<a.length;f++)i=a[f],n[i]&&l.push(n[i][0]),n[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);for(s&&s(e);l.length;)l.shift()();return c.push.apply(c,p||[]),o()}function o(){for(var t,e=0;e<c.length;e++){for(var o=c[e],r=!0,a=1;a<o.length;a++){var u=o[a];0!==n[u]&&(r=!1)}r&&(c.splice(e--,1),t=i(i.s=o[0]))}return t}var r={},n={2:0},c=[];function i(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=r,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(o,r,function(e){return t[e]}.bind(null,r));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/lib/";var a=window.webpackJsonp=window.webpackJsonp||[],u=a.push.bind(a);a.push=e,a=a.slice();for(var p=0;p<a.length;p++)e(a[p]);var s=u;return c.push([14,0]),o()}({14:function(t,e,o){"use strict";o.r(e),o.d(e,"crudDomainStore",function(){return j}),o.d(e,"Crud",function(){return M}),o.d(e,"withCrud",function(){return w});var r,n,c=o(5),i=o(1),a=o(2),u=o.n(a),p=o(4),s=o.n(p);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function b(t){return function(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e,o){return e&&v(t.prototype,e),o&&v(t,o),t}function O(t,e,o,r,n){var c={};return Object.keys(r).forEach(function(t){c[t]=r[t]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=o.slice().reverse().reduce(function(o,r){return r(t,e,o)||o},c),n&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(n):void 0,c.initializer=void 0),void 0===c.initializer&&(Object.defineProperty(t,e,c),c=null),c}var j=(O((r=function(){function t(e,o,r,n){g(this,t),this.modelName=void 0,this.mapStore=i.u.map(),this.rootStore=void 0,this.SERVER=void 0,this.offlineStorage=void 0,this.notificationDomainStore=void 0,this.rootStore=e,this.notificationDomainStore=n,o&&(this.offlineStorage=o),this.SERVER=r}return S(t,[{key:"forceUpdate",value:function(t){var e=this.mapStore.get(t);this.mapStore.set(t,[]),this.mapStore.set(t,e)}},{key:"getModel",value:function(t,e,o,r){var n=this;if(!this.mapStore.get(e)||o)return this.offlineStorage.getItem("jwtToken").then(function(o){return s.a.get("".concat(n.SERVER.host,":").concat(n.SERVER.port,"/").concat(e),{params:{token:o,query:t}}).then(function(t){Object(i.x)(function(){if(r){var o=r(t.data);return n.mapStore.set(e,o)}n.mapStore.set(e,t.data)})}).catch(function(t){n.setError(e,t)})}).catch(function(t){return n.setError(e,t)})}},{key:"createModel",value:function(t,e){var o=this;return this.offlineStorage.getItem("jwtToken").then(function(r){return s.a.post("".concat(o.SERVER.host,":").concat(o.SERVER.port,"/").concat(t,"/create"),{model:e,token:r}).then(function(r){var n=o.mapStore.get(t)||[e];return o.mapStore.set(t,b(n).concat([r.data])),o.setSuccess(t,"".concat(t," successfully created!")),r.data}).catch(function(e){return console.error("Create ".concat(t," failed!"),e),o.setError(t,e)})})}},{key:"updateModel",value:function(t,e,o){var r=this;Object(i.A)(e);return console.log("here"),Object.keys(o).map(function(t){e[t]=o[t]}),this.offlineStorage.getItem("jwtToken").then(function(o){return s.a.put("".concat(r.SERVER.host,":").concat(r.SERVER.port,"/").concat(t),{model:e,token:o}).then(function(o){var n=r.mapStore.get(t).map(function(t){return t._id===e._id?e:t});return r.mapStore.set(t,n),r.setSuccess(t,"".concat(t," successfully updated!")),o.data}).catch(function(e){return console.log("err",e),r.setError(t,e)})})}},{key:"deleteModel",value:function(t,e){var o=this;return e.deleted=!0,this.forceUpdate(t),this.offlineStorage.getItem("jwtToken").then(function(r){return s.a.delete("".concat(o.SERVER.host,":").concat(o.SERVER.port,"/").concat(t,"/").concat(e._id),{params:{token:r}}).then(function(e){return o.setSuccess(t,"".concat(t," successfully deleted!")),e.data}).catch(function(e){return o.setError(t,e)})})}},{key:"searchModel",value:function(t,e){var o=this;return this.offlineStorage.getItem("jwtToken").then(function(r){return s.a.post("".concat(o.SERVER.host,":").concat(o.SERVER.port,"/").concat(t,"/search"),{query:e,token:r}).then(function(t){return t.data}).catch(function(e){return o.setError(t,e)})})}},{key:"setError",value:function(t,e){this.notificationDomainStore&&this.notificationDomainStore.saveNotification(t,{message:e&&e.response&&e.response.data.message,type:"error"})}},{key:"setSuccess",value:function(t,e){this.notificationDomainStore&&this.notificationDomainStore.saveNotification(t,{message:e,type:"success"})}},{key:"getAppSettings",value:function(){var t=this;return this.offlineStorage.getItem("jwtToken").then(function(e){return s.a.get("".concat(t.SERVER.host,":").concat(t.SERVER.port,"/settings"),{params:{token:e}}).then(function(e){return Object(i.x)(function(){t.mapStore.set("settings",e.data)}),e.data[0]}).catch(function(e){t.setError("settings",e)})})}}]),t}()).prototype,"forceUpdate",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"forceUpdate"),r.prototype),O(r.prototype,"getModel",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"getModel"),r.prototype),O(r.prototype,"createModel",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"createModel"),r.prototype),O(r.prototype,"updateModel",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"updateModel"),r.prototype),O(r.prototype,"deleteModel",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"deleteModel"),r.prototype),O(r.prototype,"searchModel",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"searchModel"),r.prototype),O(r.prototype,"setError",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"setError"),r.prototype),O(r.prototype,"setSuccess",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"setSuccess"),r.prototype),O(r.prototype,"getAppSettings",[i.h],Object.getOwnPropertyDescriptor(r.prototype,"getAppSettings"),r.prototype),r),E=function(t,e,o,r,n,c){var i=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},r=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),r.forEach(function(e){m(t,e,o[e])})}return t}({getModel:function(o){return t.getModel(o,e,!0,c)},createModel:function(o){return t.createModel(e,o)},updateModel:function(o,r){return t.updateModel(e,o,r)},deleteModel:function(o){return t.deleteModel(e,o)},query:n},o,r.props);return i[e]=c?c(t.mapStore.get(e)):t.mapStore.get(e),i["".concat(e,"_getModel")]=function(o){t.getModel(o,e,!0,c)},i["".concat(e,"_createModel")]=function(o){return t.createModel(e,o)},i["".concat(e,"_updateModel")]=function(o,r){return t.updateModel(e,o,r)},i["".concat(e,"_deleteModel")]=function(o){return t.deleteModel(e,o)},i["".concat(e,"_searchModel")]=function(o){return t.searchModel(e,o)},i.searchModels=function(e,o){return e.map(function(e){return t.searchModel(e,o).then(function(t){return{modelName:e,res:t}})})},i["".concat(e,"_query")]=n,i},M=Object(c.a)(n=function(t){function e(t){return g(this,e),l(this,d(e).call(this,t))}return y(e,u.a.Component),S(e,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(t){}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var t=this,e=this.props,o=e.modelName,r=e.children,n=e.crudDomainStore,c=e.skipLoadOnInit,i=e.query,a=e.transform;o&&!c&&n.getModel(i,o,!1);var p=u.a.Children.map(r,function(e){var r=E(n,o,t.props,e,i,a);return u.a.cloneElement(e,r)});return u.a.createElement(u.a.Fragment,null,p)}}]),e}())||n;function w(t){var e;return Object(c.a)(e=function(e){function o(t){return g(this,o),l(this,d(o).call(this,t))}return y(o,u.a.Component),S(o,[{key:"componentDidMount",value:function(){var t=this.props,e=t.modelName,o=t.crudDomainStore,r=t.query;o.getModel(r,e,!1)}},{key:"componentWillReceiveProps",value:function(){}},{key:"render",value:function(){var e=this.props,o=e.modelName,r=e.crudDomainStore,n=e.query,c=e.transform,i=E(r,o,this.props,this,n,c);return u.a.createElement(t,i)}}]),o}())||e}}})});